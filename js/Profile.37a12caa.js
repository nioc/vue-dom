(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["Profile"],{"66aa":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",{staticClass:"hero"},[s("div",{staticClass:"hero-head"},[s("breadcrumb",{attrs:{items:[{link:{name:"profile"},icon:"fa-user",text:"Profile",isActive:!0}]}})],1),s("div",{staticClass:"hero-body has-padding-horizontal-7"},[s("div",{staticClass:"container"},[s("div",{staticClass:"card has-margin-bottom-6"},[e._m(0),s("section",{staticClass:"card-content"},[s("div",{staticClass:"field"},[s("div",{staticClass:"control has-icons-left"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.login,expression:"user.login"}],staticClass:"input",attrs:{type:"text",placeholder:"Nom d'utilisateur"},domProps:{value:e.user.login},on:{input:function(t){t.target.composing||e.$set(e.user,"login",t.target.value)}}}),e._m(1)])]),s("div",{staticClass:"field"},[s("div",{staticClass:"control has-icons-left"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.email,expression:"user.email"}],staticClass:"input",attrs:{type:"email",placeholder:"Adresse mail"},domProps:{value:e.user.email},on:{input:function(t){t.target.composing||e.$set(e.user,"email",t.target.value)}}}),e._m(2)])]),s("div",{staticClass:"field"},[s("div",{staticClass:"control"},[s("button",{staticClass:"button is-primary",on:{click:e.updateProfile}},[e._m(3),s("span",[e._v("Sauvegarder")])])])])])]),s("div",{staticClass:"card has-margin-bottom-6"},[e._m(4),s("section",{staticClass:"card-content"},[s("div",{staticClass:"field has-addons"},[s("div",{staticClass:"control has-icons-left is-expanded"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.user.password,expression:"user.password"}],staticClass:"input",attrs:{type:"password",placeholder:"Password"},domProps:{value:e.user.password},on:{input:function(t){t.target.composing||e.$set(e.user,"password",t.target.value)}}}),e._m(5)]),s("div",{staticClass:"control"},[s("button",{staticClass:"button is-primary",on:{click:e.updatePassword}},[e._m(6),s("span",[e._v("Sauvegarder")])])])]),s("table",{staticClass:"table is-fullwidth"},[e._m(7),s("tbody",e._l(e.tokens,(function(t){return s("tr",{key:t.id},[s("td",[e._v(e._s(e._f("moment")(t.issuedDate,"LLLL")))]),s("td",[e._v(e._s(t.userAgent))]),s("td",[e._v(e._s(t.ip))]),s("td",{staticClass:"has-text-centered"},[s("button",{staticClass:"button is-danger is-light is-small",on:{click:function(s){return e.deleteToken(t.id)}}},[s("i",{staticClass:"fa fa-trash"})])])])})),0)])])])])])])},n=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[s("span",{staticClass:"icon"},[s("i",{staticClass:"fa fa-user-edit"})]),s("span",[e._v("Mes informations")])])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon is-small is-left"},[s("i",{staticClass:"fas fa-user"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon is-small is-left"},[s("i",{staticClass:"fas fa-envelope"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon"},[s("i",{staticClass:"fa fa-save"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("header",{staticClass:"card-header"},[s("p",{staticClass:"card-header-title"},[s("span",{staticClass:"icon"},[s("i",{staticClass:"fa fa-user-shield"})]),s("span",[e._v("Sécurité")])])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon is-small is-left"},[s("i",{staticClass:"fas fa-key"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",{staticClass:"icon"},[s("i",{staticClass:"fa fa-save"})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("thead",[s("tr",[s("th",[e._v("Date d'autorisation")]),s("th",[e._v("User agent")]),s("th",[e._v("Adresse IP")]),s("th",{staticClass:"has-text-centered"},[e._v("Révoquer")])])])}],r=(s("c740"),s("a434"),s("96cf"),s("1da1")),i=s("5530"),o=s("2fbc"),c=s("a984"),u=s("2f62"),l=Object(u["a"])("app"),d=l.mapState,p={name:"Profile",components:{Breadcrumb:o["a"]},mixins:[c["a"]],data:function(){return{user:{},tokens:[]}},computed:Object(i["a"])({},d(["id"])),mounted:function(){this.getProfile(),this.getTokens()},methods:{getProfile:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$Provider.getMyProfile();case 3:e.user=t.sent,e.addUnsavedChangesGuard("user"),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e.$store.commit("app/setInformation",{type:"is-danger",message:"Erreur lors de la récupération du profil<br/>".concat(t.t0.message)});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},getTokens:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$Provider.getMyTokens();case 3:e.tokens=t.sent,t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](0),e.$store.commit("app/setInformation",{type:"is-danger",message:"Erreur lors de la récupération des tokens<br/>".concat(t.t0.message)});case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))()},updateProfile:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=Object.assign({},e.user),delete s.password,delete s.modificationDate,t.prev=3,t.next=6,e.$Provider.updateMyProfile(s);case 6:e.user=t.sent,e.addUnsavedChangesGuard("user"),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](3),e.$store.commit("app/setInformation",{type:"is-danger",message:t.t0.message});case 13:case"end":return t.stop()}}),t,null,[[3,10]])})))()},updatePassword:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$Provider.updateMyPassword(e.user.password);case 3:e.user.password=void 0,e.addUnsavedChangesGuard("user"),t.next=10;break;case 7:t.prev=7,t.t0=t["catch"](0),e.$store.commit("app/setInformation",{type:"is-danger",message:t.t0.message});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},deleteToken:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:t.$buefy.dialog.confirm({type:"is-danger",title:"Confirmation de suppression",message:"<p>Le jeton sera supprimé.</p><p>Souhaitez-vous continuer ?</p>",hasIcon:!0,icon:"trash",iconPack:"fa",confirmText:"Supprimer",cancelText:"Annuler",onConfirm:function(){var s=Object(r["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,t.$Provider.deleteMyToken(e);case 3:t.tokens.splice(t.tokens.findIndex((function(t){return t.id===e})),1),s.next=9;break;case 6:s.prev=6,s.t0=s["catch"](0),t.$store.commit("app/setInformation",{type:"is-danger",message:s.t0.message});case 9:case"end":return s.stop()}}),s,null,[[0,6]])})));function a(){return s.apply(this,arguments)}return a}()});case 1:case"end":return s.stop()}}),s)})))()}}},f=p,m=s("2877"),h=Object(m["a"])(f,a,n,!1,null,null,null);t["default"]=h.exports},a984:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));s("d3b7");var a={beforeRouteUpdate:function(e,t,s){this.askConfirmation().then((function(){return s()})).catch((function(){return s(!1)}))},beforeRouteLeave:function(e,t,s){this.askConfirmation().then((function(){return s()})).catch((function(){return s(!1)}))},beforeMount:function(){window.addEventListener("beforeunload",this.preventClose)},beforeDestroy:function(){window.removeEventListener("beforeunload",this.preventClose)},data:function(){return{hasUnsavedChanges:!1,unwatch:null}},methods:{addUnsavedChangesGuard:function(e){var t=this;this.removeUnsavedChangesGuard(),this.unwatch=this.$watch(e,(function(){t.hasUnsavedChanges=!0}),{deep:!0})},removeUnsavedChangesGuard:function(){this.unwatch&&(this.unwatch(),this.unwatch=null,this.hasUnsavedChanges=!1)},preventClose:function(e){this.hasUnsavedChanges&&(e.returnValue="Modifications non enregistrées")},askConfirmation:function(){var e=this;return new Promise((function(t,s){if(!e.hasUnsavedChanges)return t();e.$buefy.dialog.confirm({type:"is-danger",title:"Modifications non enregistrées",message:"<p>Vos changements seront perdus si vous quittez la page.</p><p>Souhaitez-vous continuer ?</p>",hasIcon:!0,icon:"save",iconPack:"fa",confirmText:"Quitter la page",cancelText:"Rester sur la page",onConfirm:function(){return t()},onCancel:function(){return s(new Error("cancel"))}})}))}}}}}]);
//# sourceMappingURL=Profile.37a12caa.js.map